# AI-Powered Business Licensing Assessment System

## Project Description

An intelligent system designed to help business owners in Israel understand the licensing requirements relevant to their specific business. 
The system is built on Django and utilizes the Perplexity API with the Llama 3.1 Sonar model to generate accurate and personalized reports.

## Key Features

- **Interactive Digital Questionnaire** - Business data collection
- **Smart Matching Engine** - Mapping between business characteristics and regulatory requirements  
- **AI-Powered Custom Reports** - Accurate Hebrew reports based on specific data
- **Intelligent Compliance Check** - Identifying discrepancies between business size and regulatory requirements
- **Word Document Processing** - Automatic conversion to structured format
- **Modern User Interface** - Responsive and accessible design
- **High Reliability** - System relies only on original data, not general knowledge

## System Requirements

- Python 3.8+
- Django 4.2+
- Internet connection (for Perplexity API)
- Perplexity API Key
- Memory: At least 2GB RAM
- Storage: At least 500MB

## Installation and Setup

### Step 1: Environment Setup
```bash
# Clone the repository
git clone <repository-url>
cd a-impact

# Create virtual environment
python -m venv venv

# Activate virtual environment
# On Windows:
venv\Scripts\activate
# On Linux/Mac:
source venv/bin/activate
```

### Step 2: Install Dependencies
```bash
pip install -r requirements.txt
```

### Step 2.5: Configure Perplexity API
1. **Get API Key**:
   - Go to https://www.perplexity.ai/
   - Create an account and verify your email address
   - Navigate to the API menu and create a new API key
   - Model in use: `sonar` (Llama 3.1 Sonar)

2. **Create .env file**:
```bash
# Create .env file in project directory
echo "PERPLEXITY_API_KEY=your-api-key-here" > .env
echo "PERPLEXITY_MODEL=sonar" >> .env
echo "DEBUG=True" >> .env
```

**Important**: Replace `your-api-key-here` with your actual API key!

### Step 3: Database Setup
```bash
# Run migrations
python manage.py migrate

# Load sample data (optional)
python load_sample_data.py
```

### Step 4: Run the Server
```bash
python manage.py runserver
```

The system will be available at: http://127.0.0.1:8000/

## New System Advantages

### Perfect Accuracy
- **Based on Real Data**: Reports are generated only from requirements in the original file
- **Contradiction Detection**: The system identifies if the business doesn't meet area or capacity requirements
- **Complete Details**: Each requirement includes authority, cost, time and all relevant details

### Full Transparency
- **Clear Sources**: Every piece of information in the report is marked with its specific source
- **Detailed Explanations**: Why a requirement is relevant or not relevant to the business
- **No General Knowledge**: The system doesn't add information that doesn't appear in the original file

### Professional Reports
- **Consistent Structure**: Executive summary, requirements, costs, action plan and recommendations
- **Accurate Costs and Times**: Based only on official data
- **Practical Recommendations**: Concrete steps for implementation

## System Usage

1. **Access Questionnaire**: Navigate to http://127.0.0.1:8000/
2. **Fill Business Details**: Name, type, area, capacity and special characteristics
3. **Receive Custom Report**: Report is automatically generated by AI
4. **Review Requirements**: Complete breakdown by priorities and categories

## System Architecture

```
a-impact/
├── manage.py                     # Django management
├── requirements.txt              # Python dependencies
├── load_sample_data.py          # Data loading script
├── business_licensing/           # Django project settings
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
├── questionnaire/               # Main Django app
│   ├── models.py               # Data models
│   ├── views.py                # Business logic
│   ├── urls.py                 # URL routing
│   └── migrations/
├── services/                   # AI services
│   ├── __init__.py
│   └── ai_service.py          # Perplexity API integration
├── data_processing/           # Data processing scripts
│   ├── docx_to_csv.py        # Word to CSV converter
│   ├── analyze_data.py       # Data analysis
│   └── restaurant_requirements*.csv/json
├── templates/                # HTML templates
│   ├── base.html
│   ├── home.html
│   ├── questionnaire.html
│   └── report.html
└── static/                  # CSS, JS, images
    ├── css/
    └── js/
```

## Technologies Used

### Backend
- **Django 4.2** - Main framework
- **Python 3.8+** - Programming language
- **SQLite** - Database (can be upgraded to PostgreSQL)

### AI & ML
- **Perplexity API** - Advanced language model for report generation
- **Llama 3.1 Sonar** - Advanced model with real-time internet access

### Frontend
- **Bootstrap 5** - Responsive design
- **JavaScript** - Interactivity
- **Font Awesome** - Icons

### Data Processing
- **python-docx** - Reading Word files
- **Polars** - Fast data processing
- **CSV/JSON** - Data formats

## AI Integration

### Perplexity API + Llama 3.1 Sonar
The system uses Perplexity API with the Llama 3.1 Sonar model - an advanced language model with real-time internet access capabilities.

### Accurate Report Generation
1. **Business Data Analysis** - The system processes questionnaire data
2. **Relevant Requirements Selection** - Advanced filtering algorithm from the original file
3. **Detailed Data Transfer** - Every relevant detail from requirements is passed to the model
4. **Data-Based Report Creation** - The model generates reports based only on provided data
5. **Design and Contradiction Detection** - The report includes identification of matches and mismatches

### Advanced Process for Accuracy
- **Complete Requirement Details Transfer**: Title, description, authority, area/capacity requirements, priority, cost and time
- **Business Size Compliance Check**: The model checks if the business meets area and capacity restrictions
- **Explicit Instructions**: The model receives instructions to rely only on provided data and not general knowledge
- **Contradiction Detection**: The model indicates if there's a contradiction between business characteristics and requirements

### Sample Data Structure Passed to Model
```
Requirements Found (6 total):
1. Business Licensing Law - Health Conditions for Food Establishments 1983
   Description: Compliance with health regulations for food establishments
   Authority: Ministry of Health
   Priority: High
   Cost: According to tariff
   Time: 2-4 weeks

2. Ministry of Health Kitchen Approval
   Description: Kitchen hygiene conditions inspection
   Authority: Ministry of Health
   ...
```

## Common Troubleshooting

### Perplexity API Errors
```bash
# Test API connection:
curl -X POST "https://api.perplexity.ai/chat/completions" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"model": "sonar", "messages": [{"role": "user", "content": "test"}]}'
```

### API Key Issues
- **Error 401**: Check that the API key is correct in the `.env` file
- **Error 400**: Check request format and ensure `PERPLEXITY_MODEL=sonar`
- **Error 429**: Exceeded API quota - wait or upgrade your plan

### Connection Issues
- **Connection Error**: Check internet connection
- **Timeout**: Increase timeout in `ai_service.py` file
- **SSL errors**: Possible local network issue

## Development and Contribution

### Adding New Requirements
1. Edit the CSV file: `data_processing/restaurant_requirements_clean.csv`
2. Run: `python load_sample_data.py`

### Changing Perplexity Model
```python
# In services/ai_service.py file - change the model
self.model = config('PERPLEXITY_MODEL', default='sonar')
# Options: 'sonar', 'llama-3.1-sonar-small-128k-online', etc.
```

### Adding Additional Languages
- Edit the prompts in `ai_service.py` file
- Add RTL support in CSS



---


